<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/dichvu.css">

    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
</head>

<body>
    <header class="header">
        <div class="menu-toggle">‚ò∞</div>
        <div class="header-title">Nh√† tr·ªç C·∫ßn Th∆°</div>
    </header>

    <div class="sidebar">
        <div class="logo_content">
            <div class="logo">
                <div class="icon">
                    <img src="../imag/moi.jpg" alt="Logo">
                </div>
                <div class="logo_name">Xin ch√†o, admin</div>
            </div>
        </div>
        <ul class="nav_list">
            <li><a href="menu.html"><span class="icon">üè†</span><span class="link_name">Trang ch·ªß</span></a></li>
            <li><a href="Quanlykhachhang.html"><span class="icon">üßë‚Äçüíº</span><span class="link_name">Qu·∫£n l√Ω kh√°ch h√†ng</span></a></li>
            <li><a href="doanhthu.html"><span class="icon">üí∞</span><span class="link_name">Doanh thu</span></a></li>
            <li><a href="dichvu.html"><span class="icon">üí°</span><span class="link_name">D·ªãch v·ª•</span></a></li>
            <li><a href="hoadon.html"><span class="icon">üßæ</span><span class="link_name">H√≥a ƒë∆°n</span></a></li>
            <li><a href="quanlihopdong.html"><span class="icon">üìÇ</span><span class="link_name">Qu·∫£n l√Ω h·ª£p ƒë·ªìng</span></a></li>
            <li><a href="dangxuat.html" class="logout-link"><span class="icon"><i class="fas fa-sign-out-alt"></i></span><span class="link_name">ƒêƒÉng Xu·∫•t</span></a></li>
        </ul>
    </div>

    <div class="content flex-grow-1 p-4">
        <div class="topbar d-flex justify-content-between align-items-center mb-4"></div>

        <!-- Qu·∫£n l√Ω ƒëi·ªán n∆∞·ªõc -->
        <div class="container">
            <div class="cf-title-03">
                <h3>Qu·∫£n l√Ω ƒëi·ªán n∆∞·ªõc</h3>
            </div>
            <div id="product-list">
                <!-- S·∫£n ph·∫©m m·∫´u ƒë∆∞·ª£c th√™m tr·ª±c ti·∫øp trong HTML -->
                <div class="product">
                    <input type="text" value="ƒêi·ªán" placeholder="T√™n s·∫£n ph·∫©m" readonly>
                    <input type="text" value="100,000 VND" placeholder="Gi√° c≈© (VNƒê)" readonly class="old-price">
                    <input type="text" value="" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" oninput="formatCurrency(this)">
                    <div class="btn-group">
                        <button class="update-btn" onclick="updateProduct(this)">C·∫≠p nh·∫≠t</button>
                    </div>
                </div>
                <div class="product">
                    <input type="text" value="N∆∞·ªõc" placeholder="T√™n s·∫£n ph·∫©m" readonly>
                    <input type="text" value="80,000 VND" placeholder="Gi√° c≈© (VNƒê)" readonly class="old-price">
                    <input type="text" value="" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" oninput="formatCurrency(this)">
                    <div class="btn-group">
                        <button class="update-btn" onclick="updateProduct(this)">C·∫≠p nh·∫≠t</button>
                    </div>
                </div>
            </div>
        </div><br>

        <!-- Qu·∫£n l√Ω d·ªãch v·ª• -->
        <div class="container">
            <div class="cf-title-03">
                <h3>Qu·∫£n l√Ω d·ªãch v·ª•</h3>
            </div>
            <div id="service-list">
                <!-- D·ªãch v·ª• m·∫´u ƒë∆∞·ª£c th√™m tr·ª±c ti·∫øp trong HTML -->
                <div class="service">
                    <input type="text" value="B√≥ng ƒë√®n LED" placeholder="T√™n s·∫£n ph·∫©m" readonly>
                    <input type="text" value="60,000 VND" placeholder="Gi√° c≈© (VNƒê)" readonly class="old-price">
                    <input type="text" value="50,000 VND" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" readonly class="new-price">
                    <div class="btn-group">
                        <button class="update-btn" onclick="updateService(this)">Ch·ªânh s·ª≠a</button>
                        <button class="delete-btn" onclick="deleteService(this)">X√≥a</button>
                    </div>
                </div>
                <div class="service">
                    <input type="text" value="V√≤i n∆∞·ªõc inox" placeholder="T√™n s·∫£n ph·∫©m" readonly>
                    <input type="text" value="150,000 VND" placeholder="Gi√° c≈© (VNƒê)" readonly class="old-price">
                    <input type="text" value="120,000 VND" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" readonly class="new-price">
                    <div class="btn-group">
                        <button class="update-btn" onclick="updateService(this)">Ch·ªânh s·ª≠a</button>
                        <button class="delete-btn" onclick="deleteService(this)">X√≥a</button>
                    </div>
                </div>
            </div>
            <button class="add-btn" onclick="addService()">‚ûï Th√™m d·ªãch v·ª•</button>
            <div class="cf-title-01">
                <h6>T·ªîNG: <span id="total-price">0 VND</span></h6>
            </div>
        </div>

    <!-- JavaScript -->
    <script>
        const toggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');
        toggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        function formatCurrency(input) {
            let value = input.value.replace(/\D/g, '');
            if (value === '') {
                input.value = '';
                return;
            }
            let number = parseInt(value, 10);
            input.value = number.toLocaleString('vi-VN') + ' VND';
        }

        function addService(name = "", price = "", oldPrice = "") {
            let serviceList = document.getElementById("service-list");
            let serviceDiv = document.createElement("div");
            serviceDiv.classList.add("service");
            serviceDiv.innerHTML = `
                <input type="text" value="${name}" placeholder="T√™n s·∫£n ph·∫©m">
                <input type="text" value="${oldPrice ? parseInt(oldPrice).toLocaleString('vi-VN') + ' VND' : ''}" placeholder="Gi√° c≈© (VNƒê)" readonly class="old-price">
                <input type="text" value="${price}" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" oninput="formatCurrency(this)">
                <div class="btn-group">
                    <button class="update-btn" onclick="updateService(this)">C·∫≠p nh·∫≠t</button>
                    <button class="delete-btn" onclick="deleteService(this)">X√≥a</button>
                </div>
            `;
            serviceList.appendChild(serviceDiv);
        }

        function updateProduct(button) {
            let productDiv = button.closest(".product");
            let inputs = productDiv.querySelectorAll("input");
            if (button.innerText === "C·∫≠p nh·∫≠t") {
                let name = inputs[0].value.trim();
                let price = inputs[2].value.trim().replace(/\D/g, '');
                if (name === "" || price === "") {
                    alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                    return;
                }
                inputs[0].setAttribute("readonly", true);
                inputs[2].setAttribute("readonly", true);
                button.innerText = "Ch·ªânh s·ª≠a";
                button.classList.remove("update-btn");
                button.classList.add("edi-btn");
                alert(`C·∫≠p nh·∫≠t th√†nh c√¥ng: ${name} - ${inputs[2].value}`);
            } else {
                inputs[0].removeAttribute("readonly");
                inputs[2].removeAttribute("readonly");
                button.innerText = "C·∫≠p nh·∫≠t";
                button.classList.remove("edi-btn");
                button.classList.add("update-btn");
            }
        }

        function updateService(button) {
            let serviceDiv = button.closest(".service");
            let inputs = serviceDiv.querySelectorAll("input");
            if (button.innerText === "C·∫≠p nh·∫≠t") {
                let name = inputs[0].value.trim();
                let price = inputs[2].value.trim().replace(/\D/g, '');
                if (name === "" || price === "") {
                    alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                    return;
                }
                inputs[0].setAttribute("readonly", true);
                inputs[2].setAttribute("readonly", true);
                button.innerText = "Ch·ªânh s·ª≠a";
                button.classList.remove("update-btn");
                button.classList.add("edi-btn");
                alert(`C·∫≠p nh·∫≠t th√†nh c√¥ng: ${name} - ${inputs[2].value}`);
            } else {
                inputs[0].removeAttribute("readonly");
                inputs[2].removeAttribute("readonly");
                button.innerText = "C·∫≠p nh·∫≠t";
                button.classList.remove("edi-btn");
                button.classList.add("update-btn");
            }
        }

        function deleteService(button) {
            if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?")) {
                button.closest(".service").remove();
            }
        }
    </script>
    <!--T√≠nh t·ªïng-->
    <script>
        // H√†m t√≠nh t·ªïng gi√° m·ªõi
        function calculateTotal() {
            const newPriceInputs = document.querySelectorAll('.new-price');
            let total = 0;

            newPriceInputs.forEach(input => {
                // L·∫•y gi√° tr·ªã t·ª´ input, lo·∫°i b·ªè " VND" v√† d·∫•u ph·∫©y
                const priceText = input.value.replace(' VND', '').replace(/,/g, '');
                const price = parseFloat(priceText) || 0; // Chuy·ªÉn th√†nh s·ªë, n·∫øu kh√¥ng h·ª£p l·ªá th√¨ tr·∫£ v·ªÅ 0
                total += price;
            });

            // ƒê·ªãnh d·∫°ng t·ªïng v·ªõi d·∫•u ph·∫©y v√† th√™m " VND"
            const formattedTotal = total.toLocaleString('vi-VN') + ' VND';
            
            // C·∫≠p nh·∫≠t t·ªïng v√†o ph·∫ßn hi·ªÉn th·ªã
            document.getElementById('total-price').textContent = formattedTotal;
        }

        // H√†m th√™m d·ªãch v·ª• m·ªõi
        function addService() {
            const serviceList = document.getElementById('service-list');
            const newService = document.createElement('div');
            newService.className = 'service';
            newService.innerHTML = `
                <input type="text" placeholder="T√™n s·∫£n ph·∫©m">
                <input type="text" placeholder="Gi√° c≈© (VNƒê)" class="old-price">
                <input type="text" placeholder="Nh·∫≠p gi√° m·ªõi (VNƒê)" class="new-price" oninput="calculateTotal()">
                <div class="btn-group">
                    <button class="update-btn" onclick="updateService(this)">Ch·ªânh s·ª≠a</button>
                    <button class="delete-btn" onclick="deleteService(this)">X√≥a</button>
                </div>
            `;
            serviceList.appendChild(newService);
            calculateTotal(); // C·∫≠p nh·∫≠t t·ªïng sau khi th√™m
        }

        // H√†m ch·ªânh s·ª≠a d·ªãch v·ª•
        function updateService(button) {
            const service = button.closest('.service');
            const inputs = service.querySelectorAll('input');
            const isReadOnly = inputs[0].hasAttribute('readonly');

            if (isReadOnly) {
                // Chuy·ªÉn sang ch·∫ø ƒë·ªô ch·ªânh s·ª≠a
                inputs.forEach(input => input.removeAttribute('readonly'));
                button.textContent = 'L∆∞u';
            } else {
                // L∆∞u v√† chuy·ªÉn v·ªÅ ch·∫ø ƒë·ªô readonly
                inputs.forEach(input => input.setAttribute('readonly', true));
                button.textContent = 'Ch·ªânh s·ª≠a';
                calculateTotal(); // C·∫≠p nh·∫≠t t·ªïng sau khi l∆∞u
            }
        }

        // H√†m x√≥a d·ªãch v·ª•
        function deleteService(button) {
            const service = button.closest('.service');
            service.remove();
            calculateTotal(); // C·∫≠p nh·∫≠t t·ªïng sau khi x√≥a
        }

        // T√≠nh t·ªïng khi trang ƒë∆∞·ª£c t·∫£i
        window.onload = calculateTotal;
    </script>
</body>
</html>
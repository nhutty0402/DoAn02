<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="../css/thongbao.css ">

        <!--css-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link href="{% static 'app/css/style.css' %}" rel="stylesheet" />
        <link href="{% static 'app/css/owl.caroysel.min.css' %}" rel="stylesheet" />
        <link href="{% static 'app/css/all.min.css' %}" rel="stylesheet" />
        <!-- js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
      
        <script src="{% static 'app/js/s3.js' %}"> </script>
        <script src="{% static 'app/js/all.min.js' %}"> </script>
        <script src="{% static 'app/js/m√Ωcript.js' %}"> </script>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    </head>
   
    <body>
        <header class="header">
            <div class="menu-toggle">‚ò∞</div>
            <div class="header-title">Nh√† tr·ªç C·∫ßn Th∆°</div>

          
          </header>
        
          <div class="sidebar">
               <div class="logo_content">
                
                <div class="logo">
                  <div class="icon">
                    <img src="../imag/moi.jpg" alt="Logo">
                  </div>
                  <div class="logo_name">Xin ch√†o, admin</div>
                </div>
                
            </div>

           <!--<div class="logo_name">Xin ch√†o, Admin</div> -->

            <ul class="nav_list">
              <li>
                <a href="menu.html">
                  <span class="icon">üè†</span>
                  <span class="link_name">Trang ch·ªß</span>
                </a>
              </li>
              <ul class="nav_list">
                <li>
                  <a href="Quanlykhachhang.html">
                    <span class="icon">üßë‚Äçüíº</span>
                    <span class="link_name">Qu·∫£n l√Ω kh√°ch h√†ng</span>
                  </a>
                </li>
              <li>
                <a href="doanhthu.html">
                  <span class="icon"> üí∞</span>
                  <span class="link_name"> doanh thu</span>
                </a>
              </li>
              <li>
                <a href="dichvu.html">
                  <span class="icon">üí°</span>
                  <span class="link_name">D·ªãch v·ª•</span>
                </a>
              </li>
              
              <!-- <li>
                <a href="dichvu.html">
                  <span class="icon">üìä</span>
                  <span class="link_name">Ch·ªâ s·ªë ƒëi·ªán n∆∞·ªõc</span>
                </a>
              </li> -->
              <li>
                <a href="hoadon.html">
                  <span class="icon">üßæ</span>
                  <span class="link_name">H√≥a ƒë∆°n</span>
                </a>
              </li>
          
              <li>
                <a href="quanlihopdong.html">
                  <span class="icon">üìÇ</span>
                  <span class="link_name">Qu·∫£n l√Ω h·ª£p ƒë·ªìng</span>
                </a>
              </li>
              <li>
                <a href="dangxuat.html" class="logout-link">
                  <span class="icon"><i class="fas fa-sign-out-alt"></i></span>
                  <span class="link_name">ƒêƒÉng Xu·∫•t</span>
                </a>
              </li>
            </ul>

          </div>
        
      
          <div class="content flex-grow-1 p-4">
            <!-- Thanh c√¥ng c·ª• ph√≠a tr√™n -->
            <div class="topbar d-flex justify-content-between align-items-center mb-4">
             
                <div>
       
                </div>
            </div>
        

             

            <div class="container mt-4">
              <!-- Tab navigation -->
              <ul class="nav nav-tabs" id="messageTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                      <button class="nav-link active" id="new-messages-tab" data-bs-toggle="tab" data-bs-target="#new-messages" type="button" role="tab" aria-controls="new-messages" aria-selected="true">Tin nh·∫Øn m·ªõi</button>
                  </li>
                  <li class="nav-item" role="presentation">
                      <button class="nav-link" id="all-messages-tab" data-bs-toggle="tab" data-bs-target="#all-messages" type="button" role="tab" aria-controls="all-messages" aria-selected="false">T·∫•t c·∫£ tin nh·∫Øn</button>
                  </li>
              </ul>
      
             <!-- Tab content -->
<!-- Tab content -->
<div class="tab-content" id="messageTabsContent">
  <!-- Tab 1: Tin nh·∫Øn m·ªõi -->
  <div class="tab-pane fade show active" id="new-messages" role="tabpanel" aria-labelledby="new-messages-tab">
      <div class="room-list-container">
          <div class="room-item alternate-row" data-message-id="msg-1">
              <p class="message-time">
                  <span class="status-dot"></span>
                  <span class="time-text"></span> <!-- Th·ªùi gian s·∫Ω ƒë∆∞·ª£c JS ch√®n -->
              </p>
              <div class="content-row">
                  <h3>STT: 1</h3>
                  <div class="info-row">
                      <p><strong>D√£y:</strong> B</p>
                      <p><strong>Ph√≤ng:</strong> 101</p>
                      <p><strong>T√™n:</strong> Ph·∫°m H·ªìng Nh·ª±t Ty</p>
                      <p><strong>L√Ω do:</strong> Qu√™n m·∫≠t kh·∫©u</p>
                      <p><strong>N·ªôi Dung:</strong> ƒê·ªïi m·∫≠t kh·∫©u thanhm</p>
                  </div>
                  <div class="action-buttons">
                      <button class="btn btn-detail" onclick="document.location='xemtin.html'">Xem tin</button>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Tab 2: T·∫•t c·∫£ tin nh·∫Øn -->
  <div class="tab-pane fade" id="all-messages" role="tabpanel" aria-labelledby="all-messages-tab">
      <div class="room-list-container">
          <div class="room-item alternate-row" data-message-id="msg-2">
              <p class="message-time">
                  <span class="status-dot"></span>
                  <span class="time-text"></span> <!-- Th·ªùi gian s·∫Ω ƒë∆∞·ª£c JS ch√®n -->
              </p>
              <div class="content-row">
                  <h3>STT: 1</h3>
                  <div class="info-row">
                      <p><strong>D√£y:</strong> B</p>
                      <p><strong>Ph√≤ng:</strong> 101</p>
                      <p><strong>T√™n:</strong> Ph·∫°m H·ªìng Nh·ª±t Ty</p>
                      <p><strong>L√Ω do:</strong> Qu√™n m·∫≠t kh·∫©u</p>
                      <p><strong>N·ªôi Dung:</strong> ƒê·ªïi m·∫≠t kh·∫©u thanhm</p>
                  </div>
                  <div class="action-buttons">
                      <button class="btn btn-detail" onclick="document.location='xemtin.html'">Xem tin</button>
                  </div>
              </div>
          </div>
          <div class="room-item alternate-row" data-message-id="msg-3">
              <p class="message-time">
                  <span class="status-dot"></span>
                  <span class="time-text"></span> <!-- Th·ªùi gian s·∫Ω ƒë∆∞·ª£c JS ch√®n -->
              </p>
              <div class="content-row">
                  <h3>STT: 2</h3>
                  <div class="info-row">
                      <p><strong>D√£y:</strong> B</p>
                      <p><strong>Ph√≤ng:</strong> 101</p>
                      <p><strong>T√™n:</strong> Ph·∫°m H·ªìng Nh·ª±t Ty</p>
                      <p><strong>L√Ω do:</strong> Qu√™n m·∫≠t kh·∫©u</p>
                      <p><strong>N·ªôi Dung:</strong> ƒê·ªïi m·∫≠t kh·∫©u thanhm</p>
                  </div>
                  <div class="action-buttons">
                      <button class="btn btn-detail" onclick="document.location='xemtin.html'">Xem tin</button>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>
      
         
        </div>
        
    </body>  
    <script>     
      const toggle = document.querySelector('.menu-toggle');
      const sidebar = document.querySelector('.sidebar');
  
      toggle.addEventListener('click', () => {
        sidebar.classList.toggle('active');
      });
    </script>
     <!-- Bootstrap JS -->
     <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<script>
// L·∫•y t·∫•t c·∫£ th·∫ª <p> trong .info-row
  document.querySelectorAll('.info-row p').forEach(p => {
    // Ch·ªâ x·ª≠ l√Ω th·∫ª <p> c√≥ <strong>N·ªôi Dung:</strong>
    if (p.querySelector('strong') && p.querySelector('strong').textContent.trim() === 'N·ªôi Dung:') {
        const text = p.childNodes[1].textContent.trim(); // L·∫•y text sau <strong>
        const words = text.split(' '); // T√°ch th√†nh m·∫£ng c√°c t·ª´

        // Ki·ªÉm tra n·∫øu s·ªë t·ª´ l·ªõn h∆°n 3
        if (words.length > 4) {
            const limitedText = words.slice(0, 4).join(' ') + '...'; // Gi·ªõi h·∫°n 3 t·ª´ v√† th√™m "..."
            p.innerHTML = `<strong>N·ªôi Dung:</strong> ${limitedText}`; // C·∫≠p nh·∫≠t n·ªôi dung
        }
    }
});
</script>


<script>
  document.addEventListener('DOMContentLoaded', function() {
      const currentDate = new Date();
  
      // Ki·ªÉm tra tr·∫°ng th√°i tab khi t·∫£i trang
      const activeTab = localStorage.getItem('activeTab');
      if (activeTab === 'all-messages') {
          const allMessagesTab = document.querySelector('#all-messages-tab');
          if (allMessagesTab) {
              const bsTab = new bootstrap.Tab(allMessagesTab);
              bsTab.show();
          }
      }
  
      // Ki·ªÉm tra tin nh·∫Øn c·∫ßn di chuy·ªÉn t·ª´ localStorage
      const messageToMove = localStorage.getItem('messageToMove');
      if (messageToMove) {
          const newMessagesContainer = document.querySelector('#new-messages .room-list-container');
          const allMessagesContainer = document.querySelector('#all-messages .room-list-container');
          
          // T√¨m tin nh·∫Øn trong tab "Tin nh·∫Øn m·ªõi"
          const itemToMove = newMessagesContainer.querySelector(`.room-item[data-message-id="${messageToMove}"]`);
          if (itemToMove) {
              // Sao ch√©p tin nh·∫Øn
              const clonedItem = itemToMove.cloneNode(true);
              
              // X√≥a tin nh·∫Øn kh·ªèi tab "Tin nh·∫Øn m·ªõi"
              itemToMove.remove();
  
              // Th√™m tin nh·∫Øn v√†o tab "T·∫•t c·∫£ tin nh·∫Øn"
              allMessagesContainer.appendChild(clonedItem);
  
              // C·∫≠p nh·∫≠t STT cho c·∫£ hai tab
              updateMessageNumbers(newMessagesContainer, '#new-messages');
              updateMessageNumbers(allMessagesContainer, '#all-messages');
  
              // X√≥a tr·∫°ng th√°i sau khi di chuy·ªÉn
              localStorage.removeItem('messageToMove');
          }
      }
  
      // H√†m th√™m th·ªùi gian v√† STT cho c√°c tin nh·∫Øn
      function addTimestampToMessages() {
          const roomItems = document.querySelectorAll('.room-item');
          
          roomItems.forEach((item, index) => {
              const messageTime = new Date(currentDate.getTime() - (index * 3600000));
              const timeString = messageTime.toLocaleString('vi-VN', {
                  hour: '2-digit',
                  minute: '2-digit',
                  day: '2-digit',
                  month: '2-digit',
                  year: 'numeric'
              });
              
              // Ch√®n th·ªùi gian v√†o span.time-text
              const timeElement = item.querySelector('.time-text');
              timeElement.textContent = timeString;
              
              // C·∫≠p nh·∫≠t STT
              const sttElement = item.querySelector('h3');
              sttElement.textContent = `STT: ${index + 1}`;
              
              // L∆∞u th·ªùi gian v√†o data attribute
              item.setAttribute('data-timestamp', messageTime.getTime());
  
              // Th√™m s·ª± ki·ªán click cho n√∫t "Xem tin"
              const viewButton = item.querySelector('.btn-detail');
              viewButton.addEventListener('click', function() {
                  // L∆∞u ID c·ªßa tin nh·∫Øn c·∫ßn di chuy·ªÉn v√†o localStorage
                  const messageId = item.getAttribute('data-message-id');
                  localStorage.setItem('messageToMove', messageId);
  
                  // L∆∞u tr·∫°ng th√°i tab "T·∫•t c·∫£ tin nh·∫Øn" v√†o localStorage
                  localStorage.setItem('activeTab', 'all-messages');
              });
          });
      }
  
      // H√†m di chuy·ªÉn tin nh·∫Øn c≈© (qu√° 1 ng√†y) t·ª´ "Tin nh·∫Øn m·ªõi" sang "T·∫•t c·∫£ tin nh·∫Øn"
      function moveOldMessages() {
          const newMessagesContainer = document.querySelector('#new-messages .room-list-container');
          const allMessagesContainer = document.querySelector('#all-messages .room-list-container');
          const oneDayInMs = 24 * 60 * 60 * 1000;
          
          const newMessageItems = newMessagesContainer.querySelectorAll('.room-item');
          
          newMessageItems.forEach(item => {
              const messageTimestamp = parseInt(item.getAttribute('data-timestamp'));
              const timeDifference = currentDate.getTime() - messageTimestamp;
              
              if (timeDifference > oneDayInMs) {
                  const clonedItem = item.cloneNode(true);
                  item.remove();
                  
                  allMessagesContainer.appendChild(clonedItem);
                  updateMessageNumbers(allMessagesContainer, '#all-messages');
                  updateMessageNumbers(newMessagesContainer, '#new-messages');
  
                  // Th√™m l·∫°i s·ª± ki·ªán click cho n√∫t "Xem tin" trong tin nh·∫Øn v·ª´a ƒë∆∞·ª£c sao ch√©p
                  const newViewButton = clonedItem.querySelector('.btn-detail');
                  newViewButton.addEventListener('click', function() {
                      const messageId = clonedItem.getAttribute('data-message-id');
                      localStorage.setItem('messageToMove', messageId);
                      localStorage.setItem('activeTab', 'all-messages');
                  });
  
                  // L∆∞u tr·∫°ng th√°i tab "T·∫•t c·∫£ tin nh·∫Øn" v√†o localStorage
                  localStorage.setItem('activeTab', 'all-messages');
              }
          });
      }
  
      // H√†m c·∫≠p nh·∫≠t s·ªë th·ª© t·ª± (STT) v√† ki·ªÉm tra th·ªùi gian
      function updateMessageNumbers(container, tabId) {
          const items = container.querySelectorAll('.room-item');
          items.forEach((item, index) => {
              const sttElement = item.querySelector('h3');
              sttElement.textContent = `STT: ${index + 1}`;
              
              // C·∫≠p nh·∫≠t th·ªùi gian n·∫øu ch∆∞a c√≥
              if (!item.querySelector('.time-text').textContent) {
                  const timestamp = parseInt(item.getAttribute('data-timestamp'));
                  const messageTime = new Date(timestamp);
                  const timeString = messageTime.toLocaleString('vi-VN', {
                      hour: '2-digit',
                      minute: '2-digit',
                      day: '2-digit',
                      month: '2-digit',
                      year: 'numeric'
                  });
                  item.querySelector('.time-text').textContent = timeString;
              }
          });
          
          if (items.length === 0 && tabId === '#new-messages') {
              container.innerHTML = '<p>Kh√¥ng c√≥ tin nh·∫Øn m·ªõi</p>';
          }
      }
  
      // Th·ª±c thi c√°c h√†m
      addTimestampToMessages();
      moveOldMessages();
      setInterval(moveOldMessages, 60000); // Ki·ªÉm tra m·ªói 1 ph√∫t
  
      // Th√™m s·ª± ki·ªán khi chuy·ªÉn ƒë·ªïi tab ƒë·ªÉ l∆∞u tr·∫°ng th√°i
      document.querySelectorAll('.nav-link').forEach(tab => {
          tab.addEventListener('click', function() {
              const tabId = this.getAttribute('id');
              if (tabId === 'all-messages-tab') {
                  localStorage.setItem('activeTab', 'all-messages');
              } else {
                  localStorage.setItem('activeTab', 'new-messages');
              }
          });
      });
  });
  </script>
     </html>
